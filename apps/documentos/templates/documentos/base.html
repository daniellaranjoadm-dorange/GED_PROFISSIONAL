<!-- VersÃ£o atualizada com botÃ£o de idiomas serÃ¡ gerada apÃ³s vocÃª enviar o conteÃºdo COMPLETO atual do seu base.html aqui. -->
{% load static %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{% block title %}GED D'OR@NGE{% endblock %}</title>

<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

<!-- Ãcones -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<!-- Fonte corporativa -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- ============================= TEMA LUXURY ============================== -->
<style>

/* =============================== TEMA LIGHT (DEFAULT) =============================== */
body[data-theme="light"],
body[data-theme="auto"] {
    --bg: #f5f5f7;
    --bg-card: #ffffff;
    --bg-sidebar: #ffffff;
    --text: #1f2937;
    --text-soft: #4b5563;
    --accent-gold: #D4AF37;
    --accent-gold-soft: rgba(212, 175, 55, 0.16);
    --accent-blue: #0E3356;
    --border: #e5e7eb;
    --shadow: rgba(15, 23, 42, 0.10);
    --sidebar-width: 240px;
}

/* =============================== MODO AUTO â†’ DARK (FOLLOW SYSTEM) =============================== */
@media (prefers-color-scheme: dark) {
    body[data-theme="auto"] {
        --bg: #050816;
        --bg-card: #15273F;
        --bg-sidebar: #0A1A2F;
        --text: #E5E9F5;
        --text-soft: #9CA3AF;
        --accent-gold: #C99700;
        --accent-gold-soft: rgba(201, 151, 0, 0.25);
        --accent-blue: #4F8AD9;
        --border: #1F3850;
        --shadow: rgba(0, 0, 0, 0.55);
    }
}

/* =============================== TEMA DARK FIXO =============================== */
body[data-theme="dark"] {
    --bg: #050816;
    --bg-card: #15273F;
    --bg-sidebar: #0A1A2F;
    --text: #E5E9F5;
    --text-soft: #9CA3AF;
    --accent-gold: #C99700;
    --accent-gold-soft: rgba(201, 151, 0, 0.25);
    --accent-blue: #4F8AD9;
    --border: #1F3850;
    --shadow: rgba(0, 0, 0, 0.55);
    --sidebar-width: 240px; /* ðŸ”¥ ESTA LINHA FALTAVA */
}

/* =============================== GERAL =============================== */
* {
    box-sizing: border-box;
    font-family: 'Inter', sans-serif;
}

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    transition: background .25s ease, color .25s ease;
}

/* =============================== LAYOUT =============================== */
.layout {
    display: flex;
    width: 100%;
    min-height: 100vh;
}

/* =============================== SIDEBAR =============================== */
.sidebar {
    width: var(--sidebar-width);
    background: var(--bg-sidebar);
    color: var(--text);
    padding: 1.5rem 1rem 1.25rem;
    display: flex;
    flex-direction: column;
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    box-shadow: 2px 0 12px var(--shadow);
    overflow-y: auto;
}

.sidebar::before {
    content: "";
    position: absolute;
    inset: 0;
    height: 95px;
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.65), rgba(212, 175, 55, 0.0) 55%);
    pointer-events: none;
    z-index: 0;
}

.sidebar-inner {
    position: relative;
    z-index: 1;
}

.sidebar-brand {
    display: flex;
    align-items: center;
    gap: .75rem;
    margin-bottom: 1.5rem;
}

.sidebar-logo {
    width: 46px;
    height: auto;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
}

.sidebar-brand-title {
    font-size: 1rem;
    font-weight: 700;
    color: var(--accent-blue);
}

.sidebar-brand-sub {
    font-size: .75rem;
    color: var(--text-soft);
}

/* =============================== LINKS =============================== */
.sidebar-section-title {
    font-size: .75rem;
    margin-top: 1rem;
    margin-bottom: .35rem;
    text-transform: uppercase;
    letter-spacing: .08em;
    color: var(--text-soft);
}

.sidebar-nav {
    list-style: none;
    padding: 0;
    margin: 0;
}

.sidebar-link {
    display: flex;
    align-items: center;
    gap: .55rem;
    padding: .55rem .75rem;
    margin-bottom: .2rem;
    color: var(--text);
    text-decoration: none;
    border-radius: 999px;
    transition: background .15s ease, color .15s ease, transform .08s ease;
    font-size: .92rem;
}

.sidebar-link i {
    color: var(--accent-blue);
}

.sidebar-link:hover {
    background: rgba(15, 23, 42, 0.04);
    transform: translateX(1px);
}

.sidebar-link.active {
    background: var(--accent-gold-soft);
    color: var(--accent-blue);
    font-weight: 600;
}

.logout-btn {
    margin-top: .75rem;
}

/* =============================== CONTEÃšDO =============================== */

/* =============================== CONTEÃšDO =============================== */

.content {
    margin-left: var(--sidebar-width);
    padding: 2rem;
    width: calc(100% - var(--sidebar-width));
    overflow-x: hidden;
    transition: background .25s ease, color .25s ease;
}

.content-inner {
    width: 100%;
    max-width: 100%;
}

/* MantÃ©m proteÃ§Ã£o da tabela */
.table-responsive {
    max-width: 100%;
    overflow-x: auto;
}

.card {
    max-width: 100%;
}

.content {
    overflow-x: hidden;
    margin-left: var(--sidebar-width);
    padding: 2rem;
    width: calc(100% - var(--sidebar-width));
    transition: background .25s ease, color .25s ease;
}

.card {
    background: var(--bg-card);
    border-color: var(--border);
    box-shadow: 0 3px 10px var(--shadow);
}

/* =============================== ALERTAS =============================== */

/* ======== Bandeiras Premium ======== */
.flag-icon {
    width: 26px;
    height: 20px;
    border-radius: 4px;
    object-fit: cover;
    box-shadow: 0 1px 3px rgba(0,0,0,0.18);
    transition: transform .15s ease;
}
.flag-icon:hover {
    transform: scale(1.08);
}
#alert-container {
    margin-bottom: 1rem;
}

/* CorreÃ§Ã£o especÃ­fica para DataTables */
.dataTables_wrapper {
    width: 100% !important;
    overflow-x: auto !important;
}
</style>

{% block extra_head %}{% endblock %}
</head>

<body data-theme="auto" id="tema-site">

<div class="layout">

<!-- SIDEBAR -->
<aside class="sidebar" style="z-index:999 !important;">
    <div class="sidebar-inner">

        <!-- Logo -->
        <div class="sidebar-brand">
            <img src="{% static 'documentos/logo_dorange.png' %}" class="sidebar-logo">
            <div>
                <div class="sidebar-brand-title">D'OR@NGE</div>
                <div class="sidebar-brand-sub">Document Management</div>
            </div>
        </div>

        <!-- Switch Tema -->

        <!-- Switch Idioma -->
        <div class="language-switcher mt-2 mb-4">
            <label class="small fw-semibold mb-1 d-block">Idioma</label>
            <div class="d-flex gap-2">
                <a href="/i18n/setlang/" onclick="setLanguage('pt-br'); return false;">
                    <img src="{% static 'flags/br.svg' %}" class="flag-icon" alt="PortuguÃªs">
                </a>
                <a href="/i18n/setlang/" onclick="setLanguage('en'); return false;">
                    <img src="{% static 'flags/us.svg' %}" class="flag-icon" alt="English">
                </a>
            </div>
        </div>

        <!-- Form oculto para troca de idioma -->
        <form id="lang-form" action="{% url 'set_language' %}" method="post" style="display:none;">
            {% csrf_token %}
            <input type="hidden" name="language" id="lang-input">
        </form>
        <script>
            function setLanguage(lang) {
                document.getElementById('lang-input').value = lang;
                document.getElementById('lang-form').submit();
            }
        </script>
        <div class="theme-switcher mt-2 mb-4">
            <label class="small fw-semibold mb-1 d-block">Tema</label>

            <div class="btn-group w-100">
                <button class="btn btn-sm btn-outline-secondary theme-btn" data-theme="light">ðŸŒž</button>
                <button class="btn btn-sm btn-outline-secondary theme-btn" data-theme="dark">ðŸŒ™</button>
                <button class="btn btn-sm btn-outline-secondary theme-btn" data-theme="auto">ðŸŒ“</button>
            </div>
        </div>

        <!-- Menus Django -->
        <div class="sidebar-section-title">Documentos</div>
        <ul class="sidebar-nav">
            <li><a href="{% url 'documentos:listar_documentos' %}" class="sidebar-link"><i class="bi bi-table"></i> Lista de Documentos</a></li>
            <li><a href="{% url 'documentos:listar_documentos' %}?status_ldp=Em RevisÃ£o" class="sidebar-link"><i class="bi bi-arrow-repeat"></i> RevisÃµes</a></li>
            <li><a href="{% url 'documentos:upload_documento' %}" class="sidebar-link"><i class="bi bi-file-earmark-plus"></i> Novo Documento</a></li>
            <li><a href="{% url 'documentos:importar_ldp' %}" class="sidebar-link"><i class="bi bi-cloud-upload"></i> Importar LDP</a></li>
        </ul>

        <div class="sidebar-section-title">Gerenciamento</div>
        <ul class="sidebar-nav">
            <!-- NOVO: Dashboard GED (global) -->
            <li><a href="/dashboard/" class="sidebar-link"><i class="bi bi-graph-up-arrow"></i> Dashboard GED</a></li>

            <!-- Antigo dashboard de documentos (renomeado) -->
            
            <li><a href="{% url 'documentos:painel_workflow' %}" class="sidebar-link"><i class="bi bi-diagram-3"></i> Workflow</a></li>
            <li><a href="{% url 'documentos:medicao' %}" class="sidebar-link"><i class="bi bi-cash-coin"></i> MediÃ§Ã£o</a></li>
            <li><a href="{% url 'documentos:configuracoes' %}" class="sidebar-link"><i class="bi bi-gear"></i> ConfiguraÃ§Ãµes</a></li>
            <li><a href="{% url 'contas:minhas_configuracoes' %}" class="sidebar-link"><i class="bi bi-person-gear"></i> Minhas ConfiguraÃ§Ãµes</a></li>
        </ul>

        {% if user.is_superuser %}
        <div class="sidebar-section-title">AdministraÃ§Ã£o</div>
        <ul class="sidebar-nav">
            <li><a href="{% url 'documentos:lixeira' %}" class="sidebar-link"><i class="bi bi-trash3"></i> Lixeira</a></li>
        </ul>
        {% endif %}

       {% if user.is_authenticated %}
<form method="post" action="{% url 'logout' %}">
    {% csrf_token %}
    <button class="btn btn-outline-secondary btn-pill logout-btn w-100">
        <i class="bi bi-box-arrow-right"></i> Logout
    </button>
</form>
{% endif %}


        <div class="sidebar-footer">Â© {{ now|date:"Y" }} â€” Dâ€™OR@NGE</div>

    </div>
</aside>

<!-- CONTEÃšDO -->
<main class="content">
    <div class="content-inner">

        {% if messages %}
        <div id="alert-container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                {{ message }}
                <button class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </div>
</main>

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- =============================== JS DO TEMA =============================== -->
<script>
const body = document.body;

// trocar tema ao clicar
document.querySelectorAll('.theme-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const theme = btn.dataset.theme;

        body.setAttribute("data-theme", theme);
        localStorage.setItem("tema_ged", theme);

        document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    });
});

// carregar tema salvo
const savedTheme = localStorage.getItem("tema_ged") || "auto";
body.setAttribute("data-theme", savedTheme);

// ativar botÃ£o correspondente
const activeBtn = document.querySelector(`.theme-btn[data-theme="${savedTheme}"]`);
if (activeBtn) activeBtn.classList.add('active');
</script>

{% block extra_js %}{% endblock %}
</body>
</html>
